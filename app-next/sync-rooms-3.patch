commit 8c3bf2b7078af9215483bcdc18ddbbd9c1364f93
Author: r0hitsharma <rs@rohit.sh>
Date:   Sun Feb 2 17:25:22 2025 +0100

    Save play state.

diff --git a/app-next/app/room/[id]/page.jsx b/app-next/app/room/[id]/page.jsx
index 93ee28a..081587c 100644
--- a/app-next/app/room/[id]/page.jsx
+++ b/app-next/app/room/[id]/page.jsx
@@ -38,7 +38,7 @@ export default async function RoomPage({ params }) {
           <div className="grid grid-cols-1 lg:grid-cols-5 gap-4">
             <div className="col-span-3 aspect-w-16 aspect-h-9">
               <div className="w-full h-full rounded-lg shadow-lg">
-                <Video id={room.id} url={room.video_url} cursor={room.cursor}/>
+                <Video id={room.id} url={room.video_url} cursor={room.cursor} state={room.video_state}/>
               </div>
             </div>
             <div className="col-span-2 bg-gray-900 text-gray-300 rounded-lg shadow-lg p-4 h-full flex flex-col">
diff --git a/app-next/components/Video.jsx b/app-next/components/Video.jsx
index 9c2ce02..3eb7a8d 100644
--- a/app-next/components/Video.jsx
+++ b/app-next/components/Video.jsx
@@ -1,11 +1,12 @@
 'use client';
 
-import { useEffect, useRef } from 'react';
+import { useEffect, useRef, useState } from 'react';
 import ReactPlayer from 'react-player/youtube';
 import { getRoom, updateRoom } from "@/roomActions";
 
-export function Video ({ id, url, cursor }) {
+export function Video ({ id, url, cursor, state }) {
   const playedSeconds = useRef(cursor);
+  const [videoState, setVideoState] = useState(state);
 
   async function refreshRoom(){
     const room = await getRoom(id);
@@ -17,13 +18,24 @@ export function Video ({ id, url, cursor }) {
   }, []);
 
   function saveRoom() {
-    updateRoom({ id, cursor: playedSeconds.current });
+    updateRoom({ id, cursor: playedSeconds.current, video_state: videoState });
   }
 
   return <ReactPlayer url={url} width={"100%"} height={"100%"} onProgress={x => {
     playedSeconds.current = parseInt(x.playedSeconds);
     saveRoom();
-  }} controls  config={{
+  }} controls
+  playing={videoState === 'playing'}
+  muted={videoState === 'playing'}
+  onPlay={() => {
+    setVideoState('playing');
+    saveRoom();
+  }}
+  onPause={() => {
+    setVideoState('paused');
+    saveRoom();
+  }}
+  config={{
     youtube: {
       playerVars: {
         start: playedSeconds.current
diff --git a/app-next/roomActions.js b/app-next/roomActions.js
index e7fe760..66f9dc0 100644
--- a/app-next/roomActions.js
+++ b/app-next/roomActions.js
@@ -30,6 +30,7 @@ export async function updateRoom(room) {
   try {
     await connection('room').where({id: room.id}).update({
       cursor: room.cursor,
+      video_state: room.video_state,
     });
   }  catch (error) {
     console.error("Error updating room:", error);
